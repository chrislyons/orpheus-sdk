# OCC036 - Edit Dialog Enhancement Plan: SpotOn Analysis & Modern UX Design

**Version:** 1.0 (Draft)
**Date:** October 22, 2025
**Status:** Draft
**Supersedes:** N/A

**Context:** Comprehensive analysis of SpotOn Button Menus and Audio Setup patterns, with modernized design proposals for Orpheus Clip Composer Edit Dialog.

---

## Executive Summary

This document synthesizes insights from the SpotOn audio playout system (2021) with modern UX principles to create a comprehensive Edit Dialog enhancement plan for Orpheus Clip Composer. SpotOn represents 20+ years of professional broadcast experience, and provides an excellent baseline for interaction patterns that have proven reliable in mission-critical environments.

**Key Findings:**

- SpotOn's mouse+modifier interaction scheme is robust and accessible
- Comprehensive fade system with Linear/Logarithmic curves and "MicroFades" for ultra-precision
- Floating control bars for live performance adjustment
- Right-click context menus with deep parameter access
- Visual feedback through button overlays and color coding
- Multi-channel routing with visual indicators

**Recommended Approach:**
Adopt SpotOn's proven patterns as foundation, then modernize with:

- JUCE-native visual language (cleaner, more consistent)
- Touch-friendly controls (minimum 44×44px targets)
- Keyboard-first navigation (full accessibility)
- Non-destructive editing with undo/redo
- Sample-accurate trim with visual waveform feedback

---

## 1. SpotOn Feature Analysis

### 1.1 Mouse Button Interaction Scheme

**SpotOn Pattern (from PDF):**

- **Left-click:** Play/Stop clip
- **Right-click:** Context menu
- **Ctrl+Right-click:** HotKey assignment
- **Shift+Ctrl+Right-click:** Group/Output selection
- **Shift+Drag:** Move button
- **Ctrl+Drag:** Copy button
- **Double-click:** Reset to default value (on parameters)

**In Waveform Editor:**

- **Left-click:** Set IN point
- **Right-click:** Set OUT point
- **Middle-click:** Jump transport to position
- **Drag handles:** Adjust IN/OUT points with visual feedback
- **Shift+Drag:** Adjust fade regions

**Accessibility Fallbacks (for users without middle button):**

- `Cmd/Ctrl+Click` = IN point
- `Shift+Click` = OUT point
- `Alt/Option+Click` = Jump transport

### 1.2 Audio Control System

#### 1.2.1 Gain Control

- **Range:** -20dB to +10dB (primary), -30dB to 0dB (alternate)
- **Interaction:** Vertical slider with numeric display
- **Special Features:**
  - **Mute:** Right-click slider → Mute (preserves gain level)
  - **Coarse Gain:** Extended 60dB range (purple labels when active)
  - **Floating Gain Bar:** Up to 4 concurrent instances
    - Mode A: ±6dB relative to preset
    - Mode B: -10dB to +10dB absolute
  - **Replay Gain:** Automatic from metadata (psychoacoustic loudness matching)
- **Visual Feedback:** Yellow "PST" button when non-default

#### 1.2.2 Pan Control

- **Stereo:** -100% left to +100% right
- **Surround:** 0-180° rotation angle
- **AutoPan:** Master/Slave automation
  - Mark alternate pan position (red pointer)
  - Pan changes with master fade in/out
  - Independent of fade law
- **Right-click:** Mark Alternate Pan

#### 1.2.3 Speed Control

- **Range:** 25% to 400% of original
- **Interaction:** Horizontal slider
- **Special Features:**
  - **Floating Speed Bar:** Live adjustment during playback
  - **Slow to Stop (x0):** Gradual slowdown (configurable 1.0s-5.0s)
  - **Visual indicator:** "@" prefix on duration when speed ≠ 100%
- **Constraints:** Red text when soundcard limits exceeded

#### 1.2.4 Fade System (Critical for OCC)

**Basic Fades:**

- **Presets:** 0, 0.1s, 0.2s, 0.3s, 0.5s, 1.0s, 1.5s, 2.0s, 3.0s, 4.0s, 5.0s, User (custom)
- **Curves:** Linear, Logarithmic
- **Independent:** Fade In and Fade Out fully independent
- **Visual:** Draggable fade regions on waveform
- **Defaults:**
  - Fade In: 0s
  - Fade Out: 0s or 100ms (configurable global default)

**MicroFades (Sub-600ms precision):**

- **Resolution:** 10ms increments
- **Range:** 0-600ms (varies by file format)
- **Visual:** Blue text when active (vs black for standard fades)
- **Profile:** Real-time rendering for ultra-smooth fades
- **Calculation:** `maxMicroFadeSamples = (sampleRate * 0.6) / (channels * bitDepth/8)`
  - Example: 44.1kHz stereo 16-bit = 697ms max
- **Fade In Menu:** 0, 10ms, 20ms, 30ms, 40ms, 50ms, 60ms, ... 690ms (10ms steps)
- **Fade Out:** No maximum limit (always applies if track reaches end)

**Fade Laws:**

- **Linear:** Straight-line amplitude ramp
- **Logarithmic:** Equal-power crossfade (default for professional use)
- **Right-click fade time:** Switch between Linear/Logarithmic

### 1.3 Trim System

**IN/OUT Points:**

- **Primary Control:** Horizontal sliders (sample-accurate)
- **Time Entry:** hh:mm:ss.tt format (75 ticks/second)
- **Increment Buttons:** ±1 tick (1/75 second = ~13.3ms at 44.1kHz = 587 samples)
- **Waveform Integration:** Visual markers draggable on waveform
- **Validation:** Prevent IN > OUT, clamp to file boundaries
- **Duration Display:** Shows trimmed duration in mm:ss format

**Visual Indicators:**

- **Trim Active:** "X" overlay on clip button duration
- **Speed Active:** "@" overlay on clip button duration
- **Combined:** "X@" when both active

### 1.4 Button Context Menu Structure

**SpotOn Two-Column Layout:**

| **Left Column (Clip Actions)** | **Right Column (Parameters)** |
| ------------------------------ | ----------------------------- |
| Cut                            | Loop                          |
| Copy                           | Stop All on Play              |
| Paste                          | Play Next                     |
| Paste Color                    | Edit with Audition...         |
| Paste Special                  | MIDI...                       |
| Swap                           | Audio...                      |
| Clear...                       | Display/HotKeys...            |
| Load...                        | Cancel                        |

**Parameter Submenus:**

1. **Audio → Gain/Pan/Speed/Output tab**
   - Gain slider with mute
   - Pan control (with AutoPan marker)
   - Speed slider (25-400%)
   - Output device selector
   - Fade In/Out times
   - Voice Over fade

2. **Audio → Trim Content tab**
   - Waveform display
   - IN/OUT markers
   - Fade regions (visual)
   - Zoom controls (1x, 2x, 4x, 8x)

3. **Audio → PlayList tab**
   - Queue multiple tracks
   - Reorder tracks
   - Per-track settings

### 1.5 Visual Indicators on Buttons

**Button Overlays (Right Edge):**

- **Loop:** Dashed circle (or solid when "Loop+ pending stop")
- **Stop All on Play:**
  - Filled square = with fade
  - Outlined square = hard stop (muted)
- **Stop Page on Play:** Diamond shape
- **Stop on Mouse Up:** White-outlined red square
- **Play Next:** Right-facing arrow

**Button State Colors:**

- **Unassigned:** Dark green
- **Loaded:** Blue (default)
- **Output-based:** All buttons on output 'a' same color
- **Genre-based:** 24 genre categories with color mapping
- **Custom:** Per-button color override
- **Color Lock:** Prevent color change when track replaced

**Button Text Indicators:**

- **Duration:**
  - Normal: `mm:ss`
  - Muted: Line through duration
  - Speed active: `@mm:ss`
  - Trimmed: `Xmm:ss`
  - Both: `X@mm:ss`

### 1.6 HotKey System

**Key Range:**

- **Function Keys:** F1-F12
- **Letters:** A-Z (case-insensitive, display uppercase)
- **Numeric Pad:** 0-9 (Num Lock must be active)

**Assignment:**

- **Method 1:** Right-click → Display/HotKeys → Assign new HotKey
- **Method 2:** Ctrl+Right-click on button → Instant assign
- **Lock to Button:** Survives track replacement
- **Duplicate Handling:**
  - **Ganged Mode:** All buttons play together
  - **Overlapped Mode:** Buttons play individually on each press (round-robin)
- **Paged Mode:** Same hotkey on different pages (e.g., button 15 and [124])

**HotKey Summary View:**

- **Sort Options:** Alphabetical, QWERTY, Numeric
- **Display:** Key | Button | GPI | Track Name
- **Status:** Shows "Locked" buttons with 'L' suffix

### 1.7 Multi-Channel Routing

**Mono Sources (8 possible outputs):**

- Front Left, Front Right, Front Centre
- LFE (Low Frequency Effects)
- Rear Left, Rear Right
- Wide Left, Wide Right
- **Default:** Front L+R

**Stereo Sources (4 possible combinations):**

- Front L/R (default)
- Effects/Centre
- Rear L/R
- Wide L/R

**Surround (Fixed Assignments):**

- **Quad:** 4ch (FL, FR, RL, RR)
- **5.1:** 6ch (FL, FR, C, LFE, RL, RR)
- **7.1:** 8ch (FL, FR, C, LFE, RL, RR, WL, WR)

**Visual Representation:**

- Colored boxes grid (8 positions)
- Active outputs highlighted
- Right-click to reassign

### 1.8 Advanced Features

**Loop+:**

- Change loop state without stopping playback
- Visual: Dashed circle → Solid circle (pending stop)

**Stop on Mouse Up:**

- Hold to play functionality
- Release Control key to keep playing after mouse up
- Must exceed minimum mouse click period

**Slow to Stop:**

- Gradual slowdown via Floating Speed Bar
- Configurable time: 1.0s, 1.5s, 2.0s, 2.5s, 3.0s, 3.5s, 4.0s, 4.5s, 5.0s
- Visual: Red x0 button when active
- Cancellable by adjusting speed manually

**AutoPan:**

- Master/Slave linking
- Pan Slave follows Pan Master's fade envelope
- Independent of fade law
- Mark alternate pan position (red pointer)

---

## 2. Current OCC Implementation Review

### 2.1 What We Have (v0.2.1-alpha)

**ClipEditDialog.h/cpp:**

- ✅ **Basic Metadata:** Name, color, clip group, file path
- ✅ **Waveform Display:** Real-time visualization with WaveformDisplay component
- ✅ **Trim Controls:**
  - IN/OUT sliders (sample-accurate)
  - Time editors (hh:mm:ss.tt format, 75 ticks/sec)
  - Increment/decrement buttons (±1 tick)
  - Duration display
- ✅ **Zoom Controls:** 1x, 2x, 4x, 8x levels
- ✅ **Fade Times:**
  - Presets: 0.0s, 0.1s, 0.2s, 0.3s, 0.5s, 1.0s, 1.5s, 2.0s, 3.0s
  - Fade curves: Linear, Equal Power, Exponential
- ✅ **Mouse Callbacks:** Left/Right/Middle click on waveform

**WaveformDisplay Component:**

- ✅ Audio file loading
- ✅ Waveform rendering
- ✅ Trim marker display
- ✅ Left-click = Set IN
- ✅ Right-click = Set OUT
- ✅ Middle-click = Jump (not yet implemented)
- ✅ Draggable trim handles (`onTrimPointsChanged` callback)
- ✅ Zoom levels (4 levels)

### 2.2 What We're Missing (vs SpotOn Baseline)

#### 2.2.1 Critical Gaps

1. **Modifier Key Accessibility:**
   - ❌ No Cmd/Ctrl+Click for IN point (middle-button alternative)
   - ❌ No Shift+Click for OUT point
   - ❌ No Alt/Option+Click for Jump

2. **Advanced Fade System:**
   - ❌ No MicroFades (10ms resolution for <600ms fades)
   - ❌ No visual fade curve selector (just combo box)
   - ❌ No fade regions on waveform display
   - ❌ No separate fade law selection (Linear vs Log)
   - ❌ Missing presets: 0.4s, 0.7s, 4.0s, 5.0s
   - ❌ No "User" custom value with fine-tune spinners

3. **Gain/Pan/Speed Controls:**
   - ❌ No gain control in Edit Dialog
   - ❌ No pan control
   - ❌ No speed control (25-400%)
   - ❌ No floating controls for live adjustment
   - ❌ No mute function
   - ❌ No Replay Gain support

4. **Right-Click Parameter Access:**
   - ❌ No right-click on sliders for advanced options
   - ❌ No right-click on fade times for curve selection
   - ❌ No right-click on parameters for reset to default

5. **Visual Feedback:**
   - ❌ No yellow "non-default" indicators
   - ❌ No blue text for MicroFades
   - ❌ No purple labels for Coarse Gain mode
   - ❌ No visual fade curves on waveform

6. **Multi-Tab Organization:**
   - ❌ No tabbed interface (Gain/Pan/Speed vs Trim vs PlayList)
   - ❌ Everything in single scroll view (less organized)

#### 2.2.2 Nice-to-Have Gaps

- ❌ No AutoPan (Master/Slave)
- ❌ No Slow to Stop feature
- ❌ No Loop+ (change loop without stopping)
- ❌ No multi-channel routing GUI
- ❌ No HotKey assignment in Edit Dialog
- ❌ No Floating Gain/Speed Bars
- ❌ No button color lock
- ❌ No button image support (BMP/JPEG backgrounds)

### 2.3 What We Do Better Than SpotOn

1. **Modern Timecode:**
   - ✅ Using hh:mm:ss.tt (75 ticks/sec) matching SpotOn
   - ✅ Sample-accurate conversion

2. **JUCE Native:**
   - ✅ Clean, modern visual design
   - ✅ Cross-platform consistency
   - ✅ Built-in accessibility support

3. **Phased Implementation:**
   - ✅ Clear separation of concerns (Phase 1/2/3 in code)
   - ✅ Ready for beat mapping (Phase 4)
   - ✅ Ready for time signature (Phase 5)

4. **Waveform Quality:**
   - ✅ WaveformDisplay is a dedicated, testable component
   - ✅ Clean separation of concerns
   - ✅ Ready for future enhancements (spectral view, etc.)

---

## 3. Modernized UX Design Proposals

### 3.1 Core Principle: Accessibility-First

**Problem Statement:**
SpotOn assumes 3-button mouse. Many users have 2-button mouse or trackpad.

**Solution:**
Every mouse action must have keyboard/modifier equivalent.

**Interaction Matrix:**

| **Action**        | **Primary Method**   | **Accessibility Alternative**  | **Keyboard Only** |
| ----------------- | -------------------- | ------------------------------ | ----------------- |
| Set IN point      | Left-click waveform  | Cmd/Ctrl+Click                 | `I` key           |
| Set OUT point     | Right-click waveform | Shift+Click                    | `O` key           |
| Jump transport    | Middle-click         | Alt/Option+Click               | `J` key           |
| Drag IN handle    | Drag left marker     | Left/Right arrow (fine)        | `Shift+[` / `]`   |
| Drag OUT handle   | Drag right marker    | Left/Right arrow (coarse)      | `Shift+{` / `}`   |
| Zoom In           | Mouse wheel up       | `Cmd/Ctrl + +`                 | `+` key           |
| Zoom Out          | Mouse wheel down     | `Cmd/Ctrl + -`                 | `-` key           |
| Reset parameter   | Double-click control | Right-click → Reset            | `Cmd/Ctrl+R`      |
| Open context menu | Right-click          | `Shift+F10` (Windows standard) | —                 |

### 3.2 Tabbed Interface Organization

**Proposed Tab Structure (matching SpotOn Audio SetUp):**

#### Tab 1: "Gain / Pan / Speed / Output"

- **Gain Section:**
  - Vertical slider (-20dB to +10dB default, -30dB to 0dB alternate)
  - Numeric entry field
  - Mute checkbox (right-click slider for quick access)
  - "Reset to 0dB" button (double-click slider)
  - Replay Gain indicator (if metadata present)
  - Floating Gain Bar toggle

- **Pan Section:**
  - Horizontal slider (-100% to +100%)
  - Numeric entry field
  - Center button (reset to 0%)
  - AutoPan marker (right-click to set alternate position)

- **Speed Section:**
  - Horizontal slider (25% to 400%)
  - Numeric entry field
  - "1x" button (reset to 100%)
  - Floating Speed Bar toggle
  - Slow to Stop control (dropdown: 1.0s-5.0s)

- **Output Section:**
  - Dropdown: Output device selector
  - "Set as Default" checkbox
  - Multi-channel routing GUI (for surround sources)

#### Tab 2: "Trim Content" (Current Phase 2 UI)

- **Waveform Display** (expanded to show fade regions)
- **Zoom Controls:** 1x, 2x, 4x, 8x, Fit (new)
- **Trim IN:**
  - Slider (sample-accurate)
  - Time editor (hh:mm:ss.tt)
  - ±1 tick buttons
  - "Go to IN" transport jump button
- **Trim OUT:**
  - Slider (sample-accurate)
  - Time editor (hh:mm:ss.tt)
  - ±1 tick buttons
  - "Go to OUT" transport jump button
- **Duration Display:** Trimmed duration (mm:ss)

#### Tab 3: "Fades / Curves"

- **Fade In Section:**
  - **Preset Dropdown:** 0, 0.1s, 0.2s, 0.3s, 0.5s, 1.0s, 1.5s, 2.0s, 3.0s, 4.0s, 5.0s, User
  - **MicroFade Mode Toggle:** Enable 10ms resolution (blue text when active)
  - **Fine-Tune Spinner:** (±10ms when MicroFade active)
  - **Curve Selector:** Linear, Logarithmic (Equal Power), Exponential
  - **Visual Preview:** Small fade curve graph
  - **Fade Region:** Draggable on waveform (orange overlay)

- **Fade Out Section:**
  - (Same controls as Fade In)
  - **Visual Preview:** Small fade curve graph
  - **Fade Region:** Draggable on waveform (blue overlay)

- **Defaults Section:**
  - "Reset to SpotOn Defaults" button (Fade In=0s, Fade Out=0.1s, Logarithmic)
  - "Reset to Zero" button (Fade In=0s, Fade Out=0s)

#### Tab 4: "PlayList / Loop" (Future Phase)

- **Loop Section:**
  - Loop checkbox
  - Loop+ mode (change without stopping)
  - Loop count (1x, 2x, 3x, Infinite)

- **PlayList Section:**
  - Queue multiple tracks
  - Reorder via drag-and-drop
  - Per-track fade crossfades

### 3.3 Visual Enhancements

#### 3.3.1 Waveform Display Improvements

**Fade Regions:**

- **Fade In:** Orange gradient overlay (left edge)
- **Fade Out:** Blue gradient overlay (right edge)
- **Draggable:** Drag fade region edge to adjust duration
- **Curve Preview:** Overlay fade law (Linear = straight, Log = curved)

**Trim Markers:**

- **IN Point:** Green vertical line with draggable handle
- **OUT Point:** Red vertical line with draggable handle
- **Hover Tooltip:** Show sample number + timestamp
- **Snap to Zero-Crossing:** Optional (Shift+Drag to override)

**Transport Position:**

- **Playhead:** Yellow vertical line (during preview playback)
- **Jump Points:** Click to jump transport (purple flash on click)

**Zoom:**

- **Pan Offset:** Horizontal scrollbar when zoomed >1x
- **Zoom to Selection:** Cmd/Ctrl+E (zoom to IN-OUT range)
- **Fit to Window:** Cmd/Ctrl+0 (reset to 1x)

#### 3.3.2 Parameter Visual Feedback

**Non-Default Indicators:**

- **Yellow Button:** Show next to parameter when value ≠ default
- **Click to Reset:** Yellow button resets to default value
- **Tooltip:** "Current: X.Xdb | Default: 0.0db"

**MicroFade Indicators:**

- **Blue Text:** Fade time shown in blue when MicroFade active
- **Icon:** Small "μ" symbol next to fade time
- **Tooltip:** "MicroFade: 10ms resolution, <600ms range"

**Coarse Gain Mode:**

- **Purple Labels:** Gain labels turn purple when extended range active
- **Range Indicator:** "Coarse: -60dB to +20dB"

### 3.4 Right-Click Context Menus

**On Sliders:**

- **Gain Slider:**
  - Mute
  - Reset to 0dB
  - Coarse Gain (60dB range)
  - Use Floating Gain Bar
  - Apply Replay Gain (if metadata present)

- **Pan Slider:**
  - Center
  - Mark Alternate Pan
  - (If surround) Rotate Clockwise
  - (If surround) Rotate Counter-Clockwise

- **Speed Slider:**
  - Reset to 1x
  - Use Floating Speed Bar
  - Slow to Stop → (submenu: 1.0s, 1.5s, 2.0s, ...)

**On Fade Time Dropdowns:**

- **Fade Curve:**
  - Linear
  - Logarithmic (Equal Power)
  - Exponential
  - Rendered Linear (visual preview)
  - Rendered Log (visual preview)

- **MicroFade:**
  - Enable MicroFades (10ms resolution)
  - User Value... (opens spinner dialog)
  - Reset to Default (Fade In=0s, Fade Out=0.1s)

**On Waveform:**

- **Click Waveform Background:**
  - Set IN Point Here
  - Set OUT Point Here
  - Jump Transport Here
  - Zoom to Selection (IN-OUT)
  - Fit to Window
  - Select All (IN=0, OUT=end)

### 3.5 Keyboard Shortcuts

**Navigation:**

- `Tab` - Cycle through controls
- `Shift+Tab` - Cycle backward
- `Cmd/Ctrl+1/2/3/4` - Switch to Tab 1/2/3/4

**Trim Points:**

- `I` - Set IN point at playhead
- `O` - Set OUT point at playhead
- `Shift+I` - Go to IN point
- `Shift+O` - Go to OUT point
- `[` - Trim IN earlier (1 tick)
- `]` - Trim IN later (1 tick)
- `{` - Trim OUT earlier (1 tick)
- `}` - Trim OUT later (1 tick)
- `X` - Select all (IN=0, OUT=end)

**Playback:**

- `Space` - Play/Stop
- `J` - Jump to clicked position
- `Home` - Jump to IN point
- `End` - Jump to OUT point

**Zoom:**

- `+` / `Cmd/Ctrl+Plus` - Zoom In
- `-` / `Cmd/Ctrl+Minus` - Zoom Out
- `Cmd/Ctrl+0` - Fit to Window
- `Cmd/Ctrl+E` - Zoom to Selection (IN-OUT)

**Parameters:**

- `Cmd/Ctrl+R` - Reset focused parameter to default
- `Double-Click` - Reset slider/knob to default

**Dialog:**

- `Enter` / `Cmd/Ctrl+S` - Save & Close (OK)
- `Esc` - Cancel without saving

---

## 4. Implementation Plan

### Phase 4.1: Accessibility & Modifier Keys (Week 1-2)

**Goal:** Ensure all mouse actions have keyboard/modifier alternatives.

**Tasks:**

1. **WaveformDisplay Enhancements:**
   - [x] Left-click = Set IN (already works)
   - [ ] `Cmd/Ctrl+Click` = Set IN (add modifier check)
   - [x] Right-click = Set OUT (already works)
   - [ ] `Shift+Click` = Set OUT (add modifier check)
   - [ ] `Alt/Option+Click` = Jump transport (add modifier check)
   - [ ] Mouse wheel = Zoom in/out
   - [ ] `Shift+Drag` IN/OUT handles = Snap to zero-crossing

2. **Keyboard Shortcuts:**
   - [ ] Implement global keyboard shortcuts (I, O, J, [, ], {, }, etc.)
   - [ ] Add KeyListener to ClipEditDialog
   - [ ] Map keys to actions (setTrimIn, setTrimOut, jumpTransport, etc.)
   - [ ] Show keyboard hints in tooltips

3. **Testing:**
   - [ ] Test all interactions without middle mouse button
   - [ ] Test all interactions keyboard-only (no mouse)
   - [ ] Verify accessibility (screen reader announces actions)

**Success Criteria:**

- ✅ User can set IN/OUT points without middle mouse button
- ✅ User can perform all editing actions keyboard-only
- ✅ All actions have visible keyboard hints (tooltips)

---

### Phase 4.2: Advanced Fade System (Week 3-4)

**Goal:** Match SpotOn's comprehensive fade system with MicroFades.

**Tasks:**

1. **MicroFade Infrastructure:**
   - [ ] Calculate `maxMicroFadeSamples` per clip (sample rate, channels, bit depth)
   - [ ] Add `bool microFadesEnabled` to ClipMetadata
   - [ ] Generate 10ms-step presets dynamically (0ms, 10ms, 20ms, ... up to max)
   - [ ] Blue text rendering for MicroFade times
   - [ ] "μ" icon indicator

2. **Fade Preset Expansion:**
   - [ ] Add missing presets: 0.4s, 0.7s, 4.0s, 5.0s
   - [ ] Add "User" custom value option
   - [ ] Fine-tune spinner (±10ms for MicroFades, ±100ms for standard)
   - [ ] "Reset to Defaults" button (SpotOn: Fade In=0s, Out=0.1s, Log)

3. **Fade Curve Selection:**
   - [ ] Separate curve dropdown (Linear, Log, Exponential)
   - [ ] Right-click fade time → Switch curve
   - [ ] Visual fade curve preview (small graph)

4. **Waveform Fade Regions:**
   - [ ] Orange gradient overlay for Fade In (left edge)
   - [ ] Blue gradient overlay for Fade Out (right edge)
   - [ ] Draggable fade region edges (adjust duration visually)
   - [ ] Curve preview overlay (Linear=straight, Log=curved)

5. **Testing:**
   - [ ] Verify MicroFade calculation for various file formats
   - [ ] Test fade region dragging (snap to sample boundaries)
   - [ ] Verify fade curve visual matches audio output

**Success Criteria:**

- ✅ MicroFades work for all file formats <600ms
- ✅ Fade regions visually match SpotOn behavior
- ✅ User can adjust fades via dropdown OR waveform drag

---

### Phase 4.3: Gain/Pan/Speed Tab (Week 5-6)

**Goal:** Add complete audio parameter control matching SpotOn.

**Tasks:**

1. **Tab UI Refactor:**
   - [ ] Implement `juce::TabbedComponent` for tab switching
   - [ ] Tab 1: Gain/Pan/Speed/Output
   - [ ] Tab 2: Trim Content (existing Phase 2 UI)
   - [ ] Tab 3: Fades/Curves (Phase 4.2 UI)
   - [ ] Tab 4: PlayList/Loop (placeholder for future)

2. **Gain Section:**
   - [ ] Vertical slider (-20dB to +10dB)
   - [ ] Numeric entry field (editable)
   - [ ] Mute checkbox
   - [ ] Right-click slider → Mute, Reset, Coarse Gain
   - [ ] Double-click → Reset to 0dB
   - [ ] Replay Gain indicator (from metadata)
   - [ ] Yellow "non-default" button

3. **Pan Section:**
   - [ ] Horizontal slider (-100% to +100%)
   - [ ] Numeric entry field
   - [ ] Center button (reset to 0%)
   - [ ] Right-click → Mark Alternate Pan (AutoPan future)

4. **Speed Section:**
   - [ ] Horizontal slider (25% to 400%)
   - [ ] Numeric entry field
   - [ ] "1x" button (reset to 100%)
   - [ ] Red text when soundcard limits exceeded
   - [ ] Right-click → Slow to Stop submenu

5. **Output Section:**
   - [ ] Dropdown: Output device selector
   - [ ] "Set as Default" checkbox
   - [ ] Multi-channel routing button (future)

6. **Testing:**
   - [ ] Verify gain changes apply immediately (non-destructive)
   - [ ] Test Replay Gain metadata detection
   - [ ] Verify pan works for stereo and surround clips

**Success Criteria:**

- ✅ Tab 1 provides full audio parameter control
- ✅ All SpotOn Gain/Pan/Speed features implemented
- ✅ Non-destructive: changes apply to playback, not audio file

---

### Phase 4.4: Right-Click Context Menus (Week 7)

**Goal:** Add professional right-click workflows.

**Tasks:**

1. **Slider Context Menus:**
   - [ ] Gain slider → Mute, Reset, Coarse Gain, Floating Bar
   - [ ] Pan slider → Center, Mark Alternate
   - [ ] Speed slider → Reset, Floating Bar, Slow to Stop
   - [ ] Trim sliders → Reset to file boundaries, Snap to zero

2. **Waveform Context Menu:**
   - [ ] Set IN Point Here
   - [ ] Set OUT Point Here
   - [ ] Jump Transport Here
   - [ ] Zoom to Selection
   - [ ] Fit to Window
   - [ ] Select All

3. **Fade Time Context Menu:**
   - [ ] Switch Fade Curve (Linear, Log, Exponential)
   - [ ] Enable MicroFades
   - [ ] User Value...
   - [ ] Reset to Default

4. **Testing:**
   - [ ] Verify all context menus appear on right-click
   - [ ] Test keyboard access (Shift+F10)
   - [ ] Verify actions execute correctly

**Success Criteria:**

- ✅ All major controls have right-click context menus
- ✅ Context menus match SpotOn patterns
- ✅ Keyboard-accessible (Shift+F10)

---

### Phase 4.5: Visual Polish & Feedback (Week 8)

**Goal:** Add visual feedback matching SpotOn's professional polish.

**Tasks:**

1. **Parameter Indicators:**
   - [ ] Yellow "non-default" buttons (click to reset)
   - [ ] Blue text for MicroFades
   - [ ] Purple labels for Coarse Gain mode
   - [ ] Icons: "μ" (MicroFade), "!" (non-default)

2. **Waveform Enhancements:**
   - [ ] Green IN marker with draggable handle
   - [ ] Red OUT marker with draggable handle
   - [ ] Yellow playhead (during preview)
   - [ ] Purple flash on jump clicks
   - [ ] Hover tooltips (sample # + timestamp)

3. **Zoom Pan Controls:**
   - [ ] Horizontal scrollbar when zoomed >1x
   - [ ] Pan offset saved per zoom level
   - [ ] "Zoom to Selection" button
   - [ ] "Fit to Window" button

4. **Tooltips:**
   - [ ] Show keyboard shortcuts in tooltips
   - [ ] Show current + default values
   - [ ] Show parameter ranges

5. **Testing:**
   - [ ] Visual QA pass (pixel-perfect alignment)
   - [ ] Test all tooltips
   - [ ] Verify colors match Inter Look And Feel

**Success Criteria:**

- ✅ Professional visual polish matching SpotOn quality
- ✅ All user actions have immediate visual feedback
- ✅ Tooltips provide helpful context

---

### Phase 4.6: Floating Controls (Future / v0.4.0+)

**Goal:** Add live performance controls (not critical for MVP).

**Tasks:**

1. **Floating Gain Bar:**
   - [ ] Up to 4 concurrent instances
   - [ ] Mode A: ±6dB relative (yellow header)
   - [ ] Mode B: -10dB to +10dB absolute (blue header)
   - [ ] Yellow "PST" button when non-default
   - [ ] Linked to main gain slider (bidirectional)

2. **Floating Speed Bar:**
   - [ ] Up to 4 concurrent instances
   - [ ] Yellow "x1" button when non-default
   - [ ] Red "x0" button for Slow to Stop
   - [ ] Configurable slowdown time (1.0s-5.0s)

3. **Window Management:**
   - [ ] Draggable, resizable windows
   - [ ] Remember position per session
   - [ ] Close button
   - [ ] Minimize to main window

**Success Criteria:**

- ✅ Floating controls work during playback
- ✅ Live adjustment without stopping audio
- ✅ Up to 4 instances per type

---

## 5. Design Decisions & Rationale

### 5.1 Why Adopt SpotOn Patterns?

**Proven in Production:**

- SpotOn has 20+ years of broadcast use
- Patterns refined through real-world professional use
- Handles edge cases we haven't encountered yet

**Accessibility Built-In:**

- Right-click context menus reduce UI clutter
- Keyboard shortcuts for all critical actions
- Modifier keys provide fallbacks for limited input devices

**Performance-Oriented:**

- Floating controls allow live adjustment without stopping
- Non-destructive editing (all parameters apply at playback)
- Sample-accurate timing throughout

### 5.2 Where We Modernize Beyond SpotOn

**JUCE Native:**

- Cleaner visual language (vs dated Windows UI)
- Consistent cross-platform appearance
- Built-in accessibility (screen readers, high contrast)

**Touch-Friendly:**

- Minimum 44×44px touch targets
- Larger sliders with better hit detection
- Gesture support (pinch-to-zoom on waveform)

**Undo/Redo:**

- Full non-destructive editing with undo stack
- Cmd/Ctrl+Z to undo trim/fade changes
- Per-dialog undo scope (doesn't affect other dialogs)

**Sample-Accurate Everywhere:**

- All time values stored as int64 samples (no float rounding)
- Tick increments calculated per-file sample rate
- Visual feedback always matches audio reality

### 5.3 What We Defer to Future Versions

**Not Critical for MVP:**

- Floating Gain/Speed Bars (v0.4.0+)
- AutoPan (Master/Slave linking) (v0.5.0+)
- Multi-channel routing GUI (v0.5.0+)
- Loop+ (change loop without stopping) (v0.5.0+)
- Slow to Stop (gradual slowdown) (v0.4.0+)
- Button images (BMP/JPEG backgrounds) (v1.0+)
- HotKey assignment in Edit Dialog (v0.6.0+)

**Reason:**

- These are nice-to-have, not blocking for professional use
- Focusing on core editing workflow first
- Can iterate based on user feedback

---

## 6. Success Metrics

### 6.1 Functional Completeness

- ✅ All SpotOn core features implemented (Phases 4.1-4.5)
- ✅ Keyboard-only editing possible (full accessibility)
- ✅ Sample-accurate trim with visual feedback
- ✅ Professional fade system (MicroFades + curves)
- ✅ Comprehensive audio parameter control

### 6.2 User Experience

- ✅ New user can edit trim/fades in <2 minutes (vs 5+ without training)
- ✅ Keyboard shortcuts discoverable via tooltips
- ✅ Right-click menus reduce UI complexity
- ✅ Visual feedback for all actions (<16ms latency)

### 6.3 Performance

- ✅ Dialog opens in <100ms (load waveform asynchronously if needed)
- ✅ Waveform zoom <50ms (pre-render at multiple levels)
- ✅ Parameter changes apply in <16ms (60fps UI responsiveness)
- ✅ No blocking operations on audio thread

### 6.4 Accessibility

- ✅ All features usable without middle mouse button
- ✅ All features usable keyboard-only
- ✅ Screen reader announces all actions
- ✅ High contrast mode supported (JUCE built-in)

---

## 7. Testing Plan

### 7.1 Unit Tests (C++)

```cpp
// Trim point validation
TEST(ClipEditDialogTest, TrimInMustBeLessThanTrimOut)
TEST(ClipEditDialogTest, TrimPointsClampToFileBoundaries)
TEST(ClipEditDialogTest, TickIncrementMatchesSampleRate)

// Fade calculation
TEST(ClipEditDialogTest, MicroFadeMaxSamplesCalculation)
TEST(ClipEditDialogTest, FadeTimeToSamplesConversion)
TEST(ClipEditDialogTest, FadeCurveRendering)

// Time conversion
TEST(ClipEditDialogTest, SamplesToTimeString_75TicksPerSecond)
TEST(ClipEditDialogTest, TimeStringToSamples_HandlesEdgeCases)
```

### 7.2 Integration Tests (Behavior)

- **Scenario 1:** User sets IN/OUT points via left/right click → Trim applied correctly
- **Scenario 2:** User sets IN via Cmd+Click (no middle button) → Trim applied correctly
- **Scenario 3:** User drags fade region → Fade time updates in dropdown
- **Scenario 4:** User enables MicroFades → Dropdown shows 10ms increments
- **Scenario 5:** User adjusts gain → Playback volume changes (non-destructive)
- **Scenario 6:** User double-clicks gain slider → Resets to 0dB

### 7.3 Manual QA (Checklist)

- [ ] Waveform loads within 100ms for 5-minute 44.1kHz stereo file
- [ ] Zoom buttons switch levels smoothly
- [ ] Trim markers draggable with visual feedback
- [ ] Fade regions visible on waveform
- [ ] Right-click context menus appear correctly
- [ ] Keyboard shortcuts work (I, O, J, [, ], {, })
- [ ] Tab switching works (Cmd+1/2/3/4)
- [ ] All tooltips show correct keyboard hints
- [ ] Yellow "non-default" buttons appear and reset works
- [ ] Blue text appears for MicroFades
- [ ] OK button saves all changes
- [ ] Cancel button discards all changes

### 7.4 Accessibility Testing

- [ ] Navigate entire dialog keyboard-only (Tab, Shift+Tab)
- [ ] Set trim points keyboard-only (I, O keys)
- [ ] Adjust parameters keyboard-only (arrow keys, spinners)
- [ ] All actions announced by screen reader (macOS VoiceOver, Windows Narrator)
- [ ] High contrast mode renders correctly
- [ ] Touch targets ≥44×44px (test on touchscreen if available)

---

## 8. Documentation Plan

### 8.1 User-Facing Documentation

**OCC User Manual (Section: "Editing Clips"):**

- Mouse button interaction reference table
- Keyboard shortcut cheatsheet
- Fade system explanation (Linear vs Log, MicroFades)
- Parameter right-click quick reference
- Common workflows:
  - "How to set precise trim points"
  - "How to create smooth fades"
  - "How to adjust gain without changing file"

### 8.2 Developer Documentation

**OCC Technical Documentation (ClipEditDialog.h):**

- Doxygen comments for all public methods
- Callback documentation (`onLeftClick`, `onRightClick`, etc.)
- Phase implementation status (what's done, what's TODO)
- Design decisions (why tabs, why MicroFades, etc.)

### 8.3 Design Documentation

**This Document (OCC036):**

- Serves as authoritative design spec for Edit Dialog
- Reference during implementation (Phases 4.1-4.6)
- Updated as we iterate (living document)

---

## 9. Open Questions

### 9.1 Pending Decisions

1. **Should we default to Linear or Logarithmic fades?**
   - SpotOn defaults to Logarithmic (professional standard)
   - Recommendation: **Logarithmic** (Equal Power) for broadcast use

2. **Should Fade Out default to 0s or 0.1s?**
   - SpotOn defaults to 0.1s (avoids clicks)
   - Recommendation: **0.1s** (safer default, user can override)

3. **Should we enable MicroFades by default?**
   - Pro: Better quality for short fades
   - Con: Might confuse users expecting standard presets
   - Recommendation: **Off by default**, enable via checkbox

4. **Should we show sample numbers or time in trim editors?**
   - SpotOn uses hh:mm:ss.tt (75 ticks/sec)
   - Recommendation: **Time by default**, show samples in tooltip

5. **Should we implement Floating Controls in v0.3.0 or defer?**
   - Pro: Great for live performance
   - Con: Adds complexity, not critical for MVP
   - Recommendation: **Defer to v0.4.0** (focus on core editing first)

### 9.2 Future Research

- **AutoPan Master/Slave Linking:** How to expose in UI without clutter?
- **Multi-Channel Routing:** Best visualization for 5.1/7.1 routing?
- **Beatgrid Integration:** How to align with Phase 4 (BPM detection)?
- **Spectral Editing:** Future waveform enhancements (FFT view)?

---

## 10. Appendix

### 10.1 SpotOn Fade Preset Values (Complete List)

| **Preset ID** | **Fade Time** | **Use Case**                  |
| ------------- | ------------- | ----------------------------- |
| 1             | 0.0 s         | Instant (no fade)             |
| 2             | 0.1 s         | Quick fade (default Fade Out) |
| 3             | 0.2 s         | Standard fade                 |
| 4             | 0.3 s         | Smooth fade                   |
| 5             | 0.5 s         | Half-second fade              |
| 6             | 1.0 s         | One-second fade               |
| 7             | 1.5 s         | Long fade                     |
| 8             | 2.0 s         | Crossfade                     |
| 9             | 3.0 s         | Extended crossfade            |
| 10            | 4.0 s         | Very long fade                |
| 11            | 5.0 s         | Maximum preset                |
| 12            | User          | Custom value (0.0s-10.0s)     |

### 10.2 MicroFade Calculation Formula

```cpp
// From SpotOn documentation
maxMicroFadeSamples = (sampleRate * 0.6) / (numChannels * (bitDepth / 8))

// Examples:
// 44.1kHz, 2ch, 16-bit: (44100 * 0.6) / (2 * 2) = 6615 samples = 0.150s = 150ms? No, wait...
// Actually: sampleRate * 0.6 = seconds, then divide by byte size? Unclear formula.

// Observed from PDF:
// "44.1kHz stereo 16-bit = 697ms max"
// This suggests: maxMicroFadeSeconds = 0.6 (600ms) + buffer for file format overhead

// Recommendation: Implement as fixed 600ms max, verify with testing
maxMicroFadeSeconds = 0.6; // 600ms for all formats (simpler, safer)
```

### 10.3 Tick Calculation (75 Ticks/Second)

```cpp
// SpotOn uses 75 ticks/second (matching timecode standard)
const int TICKS_PER_SECOND = 75;

// 1 tick = 1/75 second
tickDurationSeconds = 1.0 / TICKS_PER_SECOND; // 0.01333... seconds

// At 44.1kHz:
tickDurationSamples = sampleRate / TICKS_PER_SECOND;
// = 44100 / 75 = 588 samples/tick

// At 48kHz:
// = 48000 / 75 = 640 samples/tick

// Format: hh:mm:ss.tt
// Example: 01:23:45.67 = 1 hour, 23 min, 45 sec, 67 ticks
```

### 10.4 References

1. **SpotOn Button Menus and Audio Setup.pdf** (David Markie, August 2021)
   - `/Users/chrislyons/dev/orpheus-sdk/apps/clip-composer/docs/OCC/peers/SpotOn Button Menus and Audio Setup.pdf`

2. **OCC021 - Product Vision** (Orpheus Clip Composer)
   - `apps/clip-composer/docs/OCC/OCC021 Orpheus Clip Composer - Product Vision.md`

3. **OCC023 - Component Architecture** (5-layer architecture)
   - `apps/clip-composer/docs/OCC/OCC023 Component Architecture v1.0.md`

4. **OCC024 - User Interaction Flows** (8 complete workflows)
   - `apps/clip-composer/docs/OCC/OCC024 User Interaction Flows v1.0.md`

5. **OCC034 - Edit Dialog v0.2.0-alpha** (Current implementation report)
   - `apps/clip-composer/docs/OCC/OCC034.md`

6. **Current Implementation Files:**
   - `apps/clip-composer/Source/UI/ClipEditDialog.h` (v0.2.1-alpha)
   - `apps/clip-composer/Source/UI/ClipEditDialog.cpp`
   - `apps/clip-composer/Source/UI/WaveformDisplay.h`
   - `apps/clip-composer/Source/UI/WaveformDisplay.cpp`

---

## Document Status

**Version:** 1.0 (Draft)
**Date:** October 22, 2025
**Author:** Claude (AI Assistant) + Chris Lyons
**Status:** Draft - Pending Review

**Next Steps:**

1. Review and approve design decisions (Chris Lyons)
2. Prioritize phases for v0.3.0-alpha (likely Phases 4.1-4.3)
3. Create implementation tickets in GitHub Issues
4. Begin Phase 4.1 development (Accessibility & Modifier Keys)

**Changelog:**

- **2025-10-22:** Initial draft (comprehensive SpotOn analysis + modern UX design)

---

**Remember:** We're building infrastructure for professionals who depend on reliability, performance, and quality. SpotOn has proven these patterns over 20 years—adopt what works, modernize where we can improve, defer what's not critical for MVP.
